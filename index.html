<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduNotes - R.I.H.S College</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 1.5rem;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255, 255, 255, 0.2);
            border-top: 6px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            font-size: 1.3rem;
            font-weight: 600;
            text-align: center;
        }

        .loading-subtext {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
        }

        .welcome-banner {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 1.5rem 2rem;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .welcome-banner h2 {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .welcome-banner p {
            margin: 0.5rem 0 0 0;
            font-size: 1rem;
            opacity: 0.95;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo h1 {
            font-size: 2rem;
            font-weight: 900;
        }

        .logo p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .cloud-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            font-size: 0.85rem;
        }

        .sync-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }

        .sync-status.syncing {
            background: #f59e0b;
        }

        .sync-status.error {
            background: #ef4444;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .role-toggle {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.7rem 1.5rem;
            border-radius: 50px;
            border: none;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .role-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .role-indicator {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .role-indicator.developer {
            background: rgba(16, 185, 129, 0.3);
        }

        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .warning-banner {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 1.5rem 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.3);
            display: none;
        }

        .warning-banner.show {
            display: block;
        }

        .warning-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .warning-text {
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .search-bar {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 2rem;
        }

        .search-controls {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 1rem;
        }

        .search-input, .filter-select {
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .search-input:focus, .filter-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .add-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: none;
        }

        .add-btn.show { display: block; }

        .add-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }

        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .notes-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .note-card {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            border-left: 5px solid #667eea;
            transition: all 0.3s;
            position: relative;
        }

        .note-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .cloud-badge-card {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #4285f4;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .note-header { margin-bottom: 1rem; }

        .subject-badge {
            display: inline-block;
            padding: 0.4rem 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .note-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .note-chapter {
            color: #666;
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
        }

        .note-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .note-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 2px solid #f0f0f0;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .note-stats {
            display: flex;
            gap: 1.5rem;
            color: #666;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }

        .note-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .btn-view {
            background: #3b82f6;
            color: white;
        }

        .btn-view:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn-download {
            background: #10b981;
            color: white;
        }

        .btn-download:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-delete {
            background: #ef4444;
            color: white;
        }

        .btn-delete:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .sidebar {
            position: sticky;
            top: 2rem;
        }

        .stats-card {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 2rem;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1.5rem;
        }

        .stat-box {
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1rem;
            text-align: center;
        }

        .stat-box.blue {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        .stat-box.purple {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }

        .stat-box.pink {
            background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            color: white;
            font-size: 2.5rem;
            font-weight: 900;
        }

        .sync-info-card {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        }

        .sync-info-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 0.5rem;
        }

        .sync-icon { font-size: 1.5rem; }

        .sync-info-text { flex: 1; }

        .sync-info-label {
            font-size: 0.85rem;
            color: #666;
        }

        .sync-info-value {
            font-weight: 600;
            color: #333;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
            overflow-y: auto;
            padding: 2rem;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 2rem;
        }

        .form-group { margin-bottom: 1.5rem; }

        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .help-text {
            font-size: 0.85rem;
            color: #666;
            margin-top: 0.5rem;
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn-primary {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            flex: 1;
            background: #e0e0e0;
            color: #333;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary:hover { background: #d0d0d0; }

        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1001;
            padding: 2rem;
        }

        .password-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .password-content {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            max-width: 450px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .password-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .password-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .password-subtitle {
            color: #666;
            margin-bottom: 2rem;
        }

        .password-input-group {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .password-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .password-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .password-error {
            color: #ef4444;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .password-error.show { display: block; }

        .no-notes {
            background: white;
            padding: 4rem 2rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        }

        .no-notes-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        .no-notes-text {
            color: #666;
            font-size: 1.2rem;
        }

        .success-message {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: #10b981;
            color: white;
            padding: 1rem 2rem;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
            z-index: 2000;
            display: none;
            animation: slideIn 0.3s ease;
        }

        .success-message.show { display: block; }

        .success-message.error {
            background: #ef4444;
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 1024px) {
            .content-grid { grid-template-columns: 1fr; }
            .search-controls { grid-template-columns: 1fr 1fr; }
            .sidebar { position: static; }
        }

        @media (max-width: 768px) {
            .welcome-banner h2 { font-size: 1.3rem; }
            .welcome-banner p { font-size: 0.9rem; }
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            .search-controls { grid-template-columns: 1fr; }
            .note-footer {
                flex-direction: column;
                align-items: flex-start;
            }
            .note-actions {
                width: 100%;
                flex-direction: column;
            }
            .btn { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loader"></div>
        <div class="loading-text" id="loadingText">Loading from GitHub...</div>
        <div class="loading-subtext" id="loadingSubtext">Please wait</div>
    </div>

    <div class="success-message" id="successMessage"></div>

    <div class="welcome-banner">
        <h2>üéì Welcome to R.I.H.S College Studentüéì</h2>
        <p>Your Gateway to Quality Education Resources</p>
    </div>

    <div class="header">
        <div class="header-content">
            <div class="logo">
                <h1>üìö EduNotes</h1>
                <p>Auto-Synced Study Material</p>
            </div>
            <div class="header-right">
                <div class="cloud-badge">
                    <span class="sync-status" id="syncStatus"></span>
                    <span id="syncBadgeText">‚òÅÔ∏è GitHub Auto-Sync</span>
                </div>
                <button class="role-toggle" id="roleToggleBtn">üë§ Switch to Developer</button>
                <span class="role-indicator" id="roleIndicator">Mode: <strong>Student</strong></span>
                <button class="role-toggle" id="aboutBtn">‚ÑπÔ∏è About</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="warning-banner" id="warningBanner">
            <div class="warning-title">‚úÖ Developer Mode Active - Auto-Sync Enabled</div>
            <div class="warning-text">
                All changes you make will be <strong>AUTOMATICALLY saved to GitHub</strong> within seconds. 
                All users will see your changes immediately after refresh. No manual upload needed!
            </div>
        </div>

        <div class="search-bar">
            <div class="search-controls">
                <input type="text" class="search-input" id="searchInput" placeholder="üîç Search notes...">
                <select class="filter-select" id="streamFilter">
                    <option value="all">All Streams</option>
                    <option value="science">Science</option>
                    <option value="arts">Arts</option>
                </select>
                <select class="filter-select" id="subjectFilter">
                    <option value="all">All Subjects</option>
                </select>
                <select class="filter-select" id="yearFilter">
                    <option value="all">All Years</option>
                    <option value="1st Year">1st Year</option>
                    <option value="2nd Year">2nd Year</option>
                    <option value="3rd Year">3rd Year</option>
                    <option value="4th Year">4th Year</option>
                </select>
                <button class="add-btn" id="addBtn">‚ûï Add Note</button>
            </div>
        </div>

        <div class="content-grid">
            <div class="notes-list" id="notesList"></div>
            <div class="sidebar">
                <div class="stats-card">
                    <h3 class="card-title">Statistics</h3>
                    <div class="stat-box blue">
                        <div class="stat-label">Total Notes</div>
                        <div class="stat-value" id="totalNotes">0</div>
                    </div>
                    <div class="stat-box purple">
                        <div class="stat-label">Total Downloads</div>
                        <div class="stat-value" id="totalDownloads">0</div>
                    </div>
                    <div class="stat-box pink">
                        <div class="stat-label">Total Views</div>
                        <div class="stat-value" id="totalViews">0</div>
                    </div>
                </div>
                <div class="sync-info-card">
                    <h3 class="card-title">‚òÅÔ∏è Sync Info</h3>
                    <div class="sync-info-item">
                        <div class="sync-icon">üîÑ</div>
                        <div class="sync-info-text">
                            <div class="sync-info-label">Backend</div>
                            <div class="sync-info-value">GitHub Actions</div>
                        </div>
                    </div>
                    <div class="sync-info-item">
                        <div class="sync-icon">üì¶</div>
                        <div class="sync-info-text">
                            <div class="sync-info-label">Total Notes</div>
                            <div class="sync-info-value" id="syncedNotes">0</div>
                        </div>
                    </div>
                    <div class="sync-info-item">
                        <div class="sync-icon">‚úÖ</div>
                        <div class="sync-info-text">
                            <div class="sync-info-label">Status</div>
                            <div class="sync-info-value" id="syncStatusText">Connected</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Modal -->
    <div class="password-modal" id="passwordModal">
        <div class="password-content">
            <div class="password-icon">üîê</div>
            <h2 class="password-title">Developer Access</h2>
            <p class="password-subtitle">Enter password to access developer mode</p>
            <form id="passwordForm">
                <div class="password-input-group">
                    <input type="password" class="password-input" id="passwordInput" placeholder="Enter password" autocomplete="off">
                    <div class="password-error" id="passwordError">‚ùå Incorrect password. Please try again.</div>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn-primary">üîì Unlock</button>
                    <button type="button" class="btn-secondary" id="cancelPasswordBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- About Modal -->
    <div class="modal" id="aboutModal">
        <div class="modal-content" style="max-width: 800px;">
            <h2 class="modal-title">About Developer</h2>
            <div id="aboutContent" style="text-align: center;">
                <div style="margin-bottom: 2rem;">
                    <img id="developerPhoto" src="" alt="Developer" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 5px solid #667eea; margin-bottom: 1rem; display: none;">
                    <div id="noPhotoPlaceholder" style="width: 150px; height: 150px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 4rem; color: white;">üë®‚Äçüíª</div>
                </div>
                <div id="aboutText" style="color: #666; line-height: 1.8; font-size: 1.1rem; text-align: center; margin-bottom: 2rem;">
                    <p>No information available yet.</p>
                </div>
                <div id="helpersSection" style="display: none; margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); border-radius: 15px;">
                    <h4 style="color: #333; margin-bottom: 1rem; font-size: 1.2rem;">ü§ù Special Thanks To</h4>
                    <div id="helpersList" style="color: #555; font-size: 1rem; line-height: 2;"></div>
                </div>
            </div>
            <div id="aboutEditSection" style="display: none;">
                <div style="background: #d1fae5; border: 2px solid #10b981; padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;">
                    <strong style="color: #065f46;">‚úÖ Auto-Sync Active:</strong> 
                    <span style="color: #065f46;">Changes will be saved automatically to GitHub!</span>
                </div>
                <div class="form-group">
                    <label class="form-label">Profile Photo</label>
                    <input type="file" class="form-input" id="photoUpload" accept="image/jpeg,image/png,image/jpg" style="padding: 0.5rem;">
                    <div class="help-text">Upload your profile photo (JPG, PNG - Max 2MB)</div>
                    <div id="photoPreview" style="margin-top: 1rem; display: none;">
                        <img id="previewImage" src="" alt="Preview" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 3px solid #667eea;">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">About You</label>
                    <textarea class="form-textarea" id="aboutTextarea" placeholder="Write something about yourself..." style="min-height: 150px;"></textarea>
                    <div class="help-text">Tell users about yourself, your expertise, and your role</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Helpers / Contributors</label>
                    <textarea class="form-textarea" id="helpersTextarea" placeholder="Enter names of people who helped (one per line)&#10;Example:&#10;John Doe - UI Design&#10;Jane Smith - Testing" style="min-height: 100px;"></textarea>
                    <div class="help-text">List people who contributed to the project (one per line)</div>
                </div>
                <div class="modal-actions">
                    <button class="btn-primary" id="saveAboutBtn">üíæ Save to GitHub</button>
                </div>
            </div>
            <div class="modal-actions" style="margin-top: 1rem;">
                <button class="btn-secondary" id="closeAboutBtn" style="flex: none; width: 100%;">Close</button>
            </div>
        </div>
    </div>

    <!-- Add Note Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <h2 class="modal-title">Add New Note</h2>
            <div style="background: #d1fae5; border: 2px solid #10b981; padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;">
                <strong style="color: #065f46;">‚úÖ Will be auto-saved to GitHub!</strong>
            </div>
            <p style="color: #666; margin-bottom: 1.5rem;">üìå Store your PDF in Google Drive and paste the shareable link below</p>
            <form id="addNoteForm">
                <div class="form-group">
                    <label class="form-label">Stream</label>
                    <select class="form-select" id="noteStream" required>
                        <option value="">Select Stream</option>
                        <option value="science">Science</option>
                        <option value="arts">Arts</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Subject</label>
                    <select class="form-select" id="noteSubject" required>
                        <option value="">Select Stream First</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Year</label>
                    <select class="form-select" id="noteYear" required>
                        <option value="">Select Year</option>
                        <option value="1st Year">1st Year</option>
                        <option value="2nd Year">2nd Year</option>
                        <option value="3rd Year">3rd Year</option>
                        <option value="4th Year">4th Year</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Chapter</label>
                    <input type="text" class="form-input" id="noteChapter" placeholder="e.g., Chapter 1: Introduction" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Google Drive Link</label>
                    <input type="url" class="form-input" id="driveLink" placeholder="https://drive.google.com/file/d/..." required>
                    <div class="help-text">
                        üìò <strong>How to get the link:</strong><br>
                        1. Upload PDF to Google Drive<br>
                        2. Right-click ‚Üí Share ‚Üí Copy link<br>
                        3. Make sure link is set to "Anyone with the link can view"
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">File Size (MB)</label>
                    <input type="number" class="form-input" id="fileSize" placeholder="e.g., 2.5" step="0.1" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Uploaded By</label>
                    <input type="text" class="form-input" id="noteUploader" placeholder="Your name" required>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn-primary">‚úÖ Add to GitHub</button>
                    <button type="button" class="btn-secondary" id="cancelAddBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // GitHub Configuration
        const urlParams = new URLSearchParams(window.location.search);
        const TOKEN_FROM_URL = urlParams.get('t');

        const GITHUB_CONFIG = {
            username: 'sd-77500',
            repo: 'edunotes-data',
            branch: 'main',
            token: TOKEN_FROM_URL || 'NO_TOKEN'
        };

        // Build URLs
        const RAW_BASE_URL = `https://raw.githubusercontent.com/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repo}/${GITHUB_CONFIG.branch}`;
        const API_BASE_URL = `https://api.github.com/repos/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repo}/contents`;
        const NOTES_URL = `${RAW_BASE_URL}/notes.json`;
        const ABOUT_URL = `${RAW_BASE_URL}/about.json`;

        let userRole = 'student';
        const DEVELOPER_PASSWORD = 'santanu@123456789';
        const ROLE_KEY = 'edunotes_user_role';
        
        let notes = [];
        let aboutData = { photoUrl: '', aboutText: '', helpers: '' };

        const subjectsByStream = {
            science: ['Botany (Hr)', 'Chemistry (Hr)', 'Mathematics (Hr)', 'Physics (Hr)', 'Zoology (Hr)'],
            arts: ['English (Hr)', 'Odia (Hr)', 'History (Hr)', 'Political Science (Hr)', 'Education (Hr)', 'Sanskrit (Hr)', 'Economics (Hr)', 'Philosophy (Hr)']
        };

        // Load data from GitHub
        async function loadFromGitHub(url, filename) {
            try {
                updateLoadingText(`Loading ${filename}...`, 'Fetching from GitHub...');
                const response = await fetch(url + '?t=' + Date.now());
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const content = await response.json();
                return content;
            } catch (error) {
                console.error(`Error loading ${filename}:`, error);
                showMessage(`‚ùå Error loading ${filename}: ${error.message}`, 5000, true);
                return null;
            }
        }

        // Get file SHA (required for GitHub API updates)
        async function getFileSHA(filename) {
            try {
                const response = await fetch(`${API_BASE_URL}/${filename}`, {
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                if (!response.ok) return null;
                const data = await response.json();
                return data.sha;
            } catch (error) {
                console.error('Error getting SHA:', error);
                return null;
            }
        }

        // Save to GitHub via API
        async function saveToGitHub(filename, content) {
            if (userRole !== 'developer') {
                showMessage('‚ùå Only developers can save data!', 3000, true);
                return false;
            }

            if (GITHUB_CONFIG.token === 'NO_TOKEN') {
                showMessage('‚ùå GitHub token not configured! Check setup instructions.', 5000, true);
                return false;
            }

            try {
                updateLoadingText(`Syncing ${filename}...`, 'Saving to GitHub...');
                showLoading(true);
                updateSyncStatus('syncing');

                const sha = await getFileSHA(filename);
                const contentBase64 = btoa(unescape(encodeURIComponent(JSON.stringify(content, null, 2))));

                const body = {
                    message: `Update ${filename} - ${new Date().toISOString()}`,
                    content: contentBase64,
                    branch: GITHUB_CONFIG.branch
                };

                if (sha) body.sha = sha;

                const response = await fetch(`${API_BASE_URL}/${filename}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to save');
                }

                showMessage(`‚úÖ ${filename} saved to GitHub successfully!`, 3000);
                updateSyncStatus('success');
                return true;
            } catch (error) {
                console.error(`Error saving ${filename}:`, error);
                showMessage(`‚ùå Error: ${error.message}`, 5000, true);
                updateSyncStatus('error');
                return false;
            } finally {
                showLoading(false);
            }
        }

        async function syncNotesFromGitHub() {
            const result = await loadFromGitHub(NOTES_URL, 'notes.json');
            if (result !== null) {
                notes = Array.isArray(result) ? result : [];
                renderNotes();
                updateStats();
                updateSyncInfo();
                updateSyncStatus('success');
            } else {
                updateSyncStatus('error');
            }
        }

        async function syncNotesToGitHub() {
            return await saveToGitHub('notes.json', notes);
        }

        async function syncAboutFromGitHub() {
            const result = await loadFromGitHub(ABOUT_URL, 'about.json');
            if (result !== null) {
                aboutData = result;
                displayAboutData();
            }
        }

        async function syncAboutToGitHub() {
            return await saveToGitHub('about.json', aboutData);
        }

        function loadUserRole() {
            try {
                const stored = localStorage.getItem(ROLE_KEY);
                if (stored) userRole = stored;
            } catch (error) {
                console.error('Error loading role:', error);
            }
        }

        function saveUserRole() {
            try {
                localStorage.setItem(ROLE_KEY, userRole);
            } catch (error) {
                console.error('Error saving role:', error);
            }
        }

        // UI Functions
        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.remove('hidden');
            } else {
                overlay.classList.add('hidden');
            }
        }

        function updateLoadingText(main, sub) {
            document.getElementById('loadingText').textContent = main;
            document.getElementById('loadingSubtext').textContent = sub;
        }

        function showMessage(text, duration = 3000, isError = false) {
            const msg = document.getElementById('successMessage');
            msg.textContent = text;
            msg.classList.add('show');
            if (isError) {
                msg.classList.add('error');
            } else {
                msg.classList.remove('error');
            }
            setTimeout(() => {
                msg.classList.remove('show');
                if (isError) msg.classList.remove('error');
            }, duration);
        }

        function updateSyncStatus(status) {
            const statusEl = document.getElementById('syncStatus');
            const statusText = document.getElementById('syncStatusText');
            const badgeText = document.getElementById('syncBadgeText');
            
            statusEl.className = 'sync-status';
            
            if (status === 'success') {
                statusText.textContent = 'Connected';
                badgeText.textContent = '‚òÅÔ∏è GitHub Synced';
            } else if (status === 'syncing') {
                statusEl.classList.add('syncing');
                statusText.textContent = 'Syncing...';
                badgeText.textContent = 'üîÑ Syncing...';
            } else if (status === 'error') {
                statusEl.classList.add('error');
                statusText.textContent = 'Error';
                badgeText.textContent = '‚ùå Sync Error';
            }
        }

        function updateSubjectOptions() {
            const stream = document.getElementById('noteStream').value;
            const subjectSelect = document.getElementById('noteSubject');
            subjectSelect.innerHTML = '<option value="">Select Subject</option>';
            if (stream && subjectsByStream[stream]) {
                subjectsByStream[stream].forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject;
                    option.textContent = subject;
                    subjectSelect.appendChild(option);
                });
            }
        }

        function updateFilterSubjects() {
            const stream = document.getElementById('streamFilter').value;
            const subjectSelect = document.getElementById('subjectFilter');
            subjectSelect.innerHTML = '<option value="all">All Subjects</option>';
            if (stream === 'all') {
                Object.values(subjectsByStream).flat().forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject;
                    option.textContent = subject;
                    subjectSelect.appendChild(option);
                });
            } else if (stream && subjectsByStream[stream]) {
                subjectsByStream[stream].forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject;
                    option.textContent = subject;
                    subjectSelect.appendChild(option);
                });
            }
        }

        function updateUI() {
            const roleToggleBtn = document.getElementById('roleToggleBtn');
            const roleIndicator = document.getElementById('roleIndicator');
            const addBtn = document.getElementById('addBtn');
            const warningBanner = document.getElementById('warningBanner');
            
            if (userRole === 'developer') {
                roleToggleBtn.innerHTML = 'üë§ Switch to Student';
                roleIndicator.innerHTML = 'Mode: <strong>Developer</strong> üîì';
                roleIndicator.classList.add('developer');
                addBtn.classList.add('show');
                warningBanner.classList.add('show');
            } else {
                roleToggleBtn.innerHTML = 'üë§ Switch to Developer';
                roleIndicator.innerHTML = 'Mode: <strong>Student</strong>';
                roleIndicator.classList.remove('developer');
                addBtn.classList.remove('show');
                warningBanner.classList.remove('show');
            }
            renderNotes();
            updateSyncInfo();
        }

        function updateSyncInfo() {
            document.getElementById('syncedNotes').textContent = notes.length;
        }

        function updateStats() {
            document.getElementById('totalNotes').textContent = notes.length;
            document.getElementById('totalDownloads').textContent = notes.reduce((sum, n) => sum + n.downloads, 0);
            document.getElementById('totalViews').textContent = notes.reduce((sum, n) => sum + n.views, 0);
        }

        // Modal Functions
        function handleRoleToggle() {
            if (userRole === 'student') {
                openPasswordModal();
            } else {
                userRole = 'student';
                saveUserRole();
                updateUI();
                showMessage('üë§ Switched to Student mode');
            }
        }

        function openPasswordModal() {
            const modal = document.getElementById('passwordModal');
            const input = document.getElementById('passwordInput');
            const error = document.getElementById('passwordError');
            modal.classList.add('active');
            input.value = '';
            error.classList.remove('show');
            setTimeout(() => input.focus(), 100);
        }

        function closePasswordModal() {
            document.getElementById('passwordModal').classList.remove('active');
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').classList.remove('show');
        }

        function checkPassword(event) {
            event.preventDefault();
            const password = document.getElementById('passwordInput').value;
            const error = document.getElementById('passwordError');
            if (password === DEVELOPER_PASSWORD) {
                userRole = 'developer';
                saveUserRole();
                closePasswordModal();
                updateUI();
                showMessage('‚úÖ Developer mode activated! Auto-sync enabled.');
            } else {
                error.classList.add('show');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }

        function openAddModal() {
            document.getElementById('addModal').classList.add('active');
        }

        function closeAddModal() {
            document.getElementById('addModal').classList.remove('active');
            document.getElementById('addNoteForm').reset();
            document.getElementById('noteSubject').innerHTML = '<option value="">Select Stream First</option>';
        }

        function openAboutModal() {
            const modal = document.getElementById('aboutModal');
            const editSection = document.getElementById('aboutEditSection');
            displayAboutData();
            if (userRole === 'developer') {
                editSection.style.display = 'block';
                document.getElementById('aboutTextarea').value = aboutData.aboutText || '';
                document.getElementById('helpersTextarea').value = aboutData.helpers || '';
                if (aboutData.photoUrl) {
                    document.getElementById('photoPreview').style.display = 'block';
                    document.getElementById('previewImage').src = aboutData.photoUrl;
                }
            } else {
                editSection.style.display = 'none';
            }
            modal.classList.add('active');
        }

        function closeAboutModal() {
            document.getElementById('aboutModal').classList.remove('active');
            document.getElementById('photoUpload').value = '';
            document.getElementById('photoPreview').style.display = 'none';
        }

        function displayAboutData() {
            const photo = document.getElementById('developerPhoto');
            const placeholder = document.getElementById('noPhotoPlaceholder');
            const text = document.getElementById('aboutText');
            const helpersSection = document.getElementById('helpersSection');
            const helpersList = document.getElementById('helpersList');
            
            if (aboutData.photoUrl) {
                photo.src = aboutData.photoUrl;
                photo.style.display = 'block';
                placeholder.style.display = 'none';
            } else {
                photo.style.display = 'none';
                placeholder.style.display = 'flex';
            }
            
            if (aboutData.aboutText) {
                text.innerHTML = aboutData.aboutText.split('\n').map(line => `<p>${line}</p>`).join('');
            } else {
                text.innerHTML = userRole === 'developer' ? 
                    '<p>No information available yet.</p><p style="margin-top: 1rem; font-size: 0.9rem; color: #999;">Add your information below.</p>' :
                    '<p>No information available yet.</p>';
            }
            
            if (aboutData.helpers && aboutData.helpers.trim()) {
                helpersSection.style.display = 'block';
                const helpersArray = aboutData.helpers.split('\n').filter(h => h.trim());
                helpersList.innerHTML = helpersArray.map(helper => `<div>‚ú® ${helper}</div>`).join('');
            } else {
                helpersSection.style.display = 'none';
            }
        }

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (file.size > 2 * 1024 * 1024) {
                showMessage('‚ùå Photo size must be less than 2MB', 3000, true);
                event.target.value = '';
                return;
            }
            if (!file.type.match('image/jpeg') && !file.type.match('image/png') && !file.type.match('image/jpg')) {
                showMessage('‚ùå Only JPG and PNG images are allowed', 3000, true);
                event.target.value = '';
                return;
            }
            const reader = new FileReader();
            reader.onload = function(e) {
                const base64Image = e.target.result;
                document.getElementById('photoPreview').style.display = 'block';
                document.getElementById('previewImage').src = base64Image;
                document.getElementById('photoUpload').dataset.base64 = base64Image;
            };
            reader.readAsDataURL(file);
        }

        async function saveAbout() {
            const aboutText = document.getElementById('aboutTextarea').value.trim();
            const helpers = document.getElementById('helpersTextarea').value.trim();
            const photoUpload = document.getElementById('photoUpload');
            
            if (photoUpload.dataset.base64) {
                aboutData.photoUrl = photoUpload.dataset.base64;
            }
            aboutData.aboutText = aboutText;
            aboutData.helpers = helpers;
            
            const success = await syncAboutToGitHub();
            if (success) {
                displayAboutData();
            }
        }

        // Note Functions
        function extractDriveId(link) {
            link = link.trim();
            const patterns = [/\/file\/d\/([a-zA-Z0-9_-]+)/, /\/open\?id=([a-zA-Z0-9_-]+)/, /id=([a-zA-Z0-9_-]+)/, /\/d\/([a-zA-Z0-9_-]+)/, /^([a-zA-Z0-9_-]{25,})$/];
            for (let pattern of patterns) {
                const match = link.match(pattern);
                if (match && match[1]) return match[1];
            }
            return null;
        }

        function getDriveViewLink(driveId) { return `https://drive.google.com/file/d/${driveId}/preview`; }
        function getDriveDownloadLink(driveId) { return `https://drive.google.com/uc?export=download&id=${driveId}`; }

        async function addNote(event) {
            event.preventDefault();
            
            const stream = document.getElementById('noteStream').value.trim();
            const subject = document.getElementById('noteSubject').value.trim();
            const year = document.getElementById('noteYear').value.trim();
            const chapter = document.getElementById('noteChapter').value.trim();
            const driveLink = document.getElementById('driveLink').value.trim();
            const fileSize = document.getElementById('fileSize').value.trim();
            const uploader = document.getElementById('noteUploader').value.trim();
            
            if (!stream || !subject || !year || !chapter || !driveLink || !fileSize || !uploader) {
                showMessage('‚ùå Please fill all fields', 3000, true);
                return;
            }
            
            if (parseFloat(fileSize) <= 0) {
                showMessage('‚ùå Please enter a valid file size', 3000, true);
                return;
            }
            
            const driveId = extractDriveId(driveLink);
            if (!driveId) {
                showMessage('‚ùå Invalid Google Drive link', 3000, true);
                return;
            }

            const newNote = {
                id: Date.now(),
                stream,
                subject,
                year,
                chapter,
                title: chapter,
                description: 'Study material for ' + chapter,
                driveLink,
                driveId,
                fileSize: fileSize + ' MB',
                uploadedBy: uploader,
                date: new Date().toISOString().split('T')[0],
                downloads: 0,
                views: 0
            };
            
            notes.unshift(newNote);
            const success = await syncNotesToGitHub();
            
            if (success) {
                closeAddModal();
                renderNotes();
                updateStats();
                updateSyncInfo();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                notes.shift();
            }
        }

        async function deleteNote(id) {
            if (!confirm('‚ö†Ô∏è Are you sure you want to delete this note?\n\nThis will sync changes to GitHub immediately.')) {
                return;
            }
            
            notes = notes.filter(note => note.id !== id);
            const success = await syncNotesToGitHub();
            
            if (success) {
                renderNotes();
                updateStats();
                updateSyncInfo();
            }
        }

        async function viewNote(id) {
            const note = notes.find(n => n.id === id);
            if (note) {
                note.views++;
                if (userRole === 'developer') {
                    await syncNotesToGitHub();
                }
                updateStats();
                window.open(getDriveViewLink(note.driveId), '_blank');
                showMessage('üëÅÔ∏è Opening PDF...');
            }
        }

        async function downloadNote(id) {
            const note = notes.find(n => n.id === id);
            if (note) {
                note.downloads++;
                if (userRole === 'developer') {
                    await syncNotesToGitHub();
                }
                updateStats();
                window.open(getDriveDownloadLink(note.driveId), '_blank');
                showMessage('üì• Download started!');
            }
        }

        function filterNotes() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const stream = document.getElementById('streamFilter').value;
            const subject = document.getElementById('subjectFilter').value;
            const year = document.getElementById('yearFilter').value;
            
            const filtered = notes.filter(note => {
                const matchSearch = note.title.toLowerCase().includes(search) || 
                                  note.chapter.toLowerCase().includes(search) || 
                                  note.subject.toLowerCase().includes(search) || 
                                  note.description.toLowerCase().includes(search);
                const matchStream = stream === 'all' || note.stream === stream;
                const matchSubject = subject === 'all' || note.subject === subject;
                const matchYear = year === 'all' || note.year === year;
                return matchSearch && matchStream && matchSubject && matchYear;
            });
            
            renderFilteredNotes(filtered);
        }

        function renderFilteredNotes(filtered) {
            const list = document.getElementById('notesList');
            if (filtered.length === 0) {
                list.innerHTML = '<div class="no-notes"><div class="no-notes-icon">üìù</div><div class="no-notes-text">No notes found</div></div>';
                return;
            }
            list.innerHTML = filtered.map(note => `
                <div class="note-card">
                    <div class="cloud-badge-card"><span>‚òÅÔ∏è</span><span>GitHub</span></div>
                    <div class="note-header">
                        <span class="subject-badge">${note.subject} - ${note.year}</span>
                        <h3 class="note-title">${note.title}</h3>
                        <p class="note-chapter">${note.chapter}</p>
                        <p class="note-description">${note.description}</p>
                    </div>
                    <div class="note-footer">
                        <div class="note-stats">
                            <span>üëÅÔ∏è ${note.views}</span>
                            <span>üì• ${note.downloads}</span>
                            <span>üìÑ ${note.fileSize}</span>
                            <span>üë§ ${note.uploadedBy}</span>
                            <span>üìÖ ${note.date}</span>
                        </div>
                        <div class="note-actions">
                            <button class="btn btn-view" onclick="viewNote(${note.id})">üëÅÔ∏è View</button>
                            <button class="btn btn-download" onclick="downloadNote(${note.id})">üì• Download</button>
                            ${userRole === 'developer' ? `<button class="btn btn-delete" onclick="deleteNote(${note.id})">üóëÔ∏è Delete</button>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderNotes() {
            renderFilteredNotes(notes);
            updateStats();
        }

        // Initialize
        async function initializeData() {
            updateLoadingText('Connecting to GitHub...', 'Initializing...');
            showLoading(true);
            
            try {
                await syncNotesFromGitHub();
                await syncAboutFromGitHub();
                showMessage('‚úÖ Successfully loaded from GitHub!');
            } catch (error) {
                showMessage('‚ùå Failed to load from GitHub: ' + error.message, 5000, true);
                updateSyncStatus('error');
            } finally {
                showLoading(false);
            }
        }

        document.addEventListener('DOMContentLoaded', async function() {
            loadUserRole();
            updateFilterSubjects();
            updateUI();
            
            await initializeData();
            
            // Event Listeners
            document.getElementById('roleToggleBtn').addEventListener('click', handleRoleToggle);
            document.getElementById('passwordForm').addEventListener('submit', checkPassword);
            document.getElementById('cancelPasswordBtn').addEventListener('click', closePasswordModal);
            document.getElementById('addBtn').addEventListener('click', openAddModal);
            document.getElementById('addNoteForm').addEventListener('submit', addNote);
            document.getElementById('cancelAddBtn').addEventListener('click', closeAddModal);
            document.getElementById('aboutBtn').addEventListener('click', openAboutModal);
            document.getElementById('closeAboutBtn').addEventListener('click', closeAboutModal);
            document.getElementById('saveAboutBtn').addEventListener('click', saveAbout);
            document.getElementById('searchInput').addEventListener('keyup', filterNotes);
            document.getElementById('streamFilter').addEventListener('change', function() {
                updateFilterSubjects();
                filterNotes();
            });
            document.getElementById('subjectFilter').addEventListener('change', filterNotes);
            document.getElementById('yearFilter').addEventListener('change', filterNotes);
            document.getElementById('noteStream').addEventListener('change', updateSubjectOptions);
            document.getElementById('photoUpload').addEventListener('change', handlePhotoUpload);
        });
    </script>
</body>
</html>
